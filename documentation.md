# 主要操作流程

## 人员分配

直播工作需要三人或三人以上

## 直播设备列表

> 占坑

## 直播软件及驱动的安装和调试
1. 安装以下两个软件
    - `DRIVER.CY3014_YS 1.1.0.149.0.exe`
    - `OBS-Studio-19.0.2-Full-Installer.exe`
    - 下载地址：网协服务器，云盘

2. OBS设置-串流
    - url:  ~~rtmp://send.livestream.bitnp.net:1935/nplive~~

      *目前是rtmp://10.2.70.123:1935/nplive，之后估计会改过来*

    - 流密钥:  livestream
3. OBS设置-输出
    - 视频比特率 2500
    - 编码器 QSV
4. OBS设置-视频 
    - 基础分辨率 1080p(1920*1080)
    - 输出分辨率 720p(1080*720)
    - 缩放过滤器 双直线法
    - FPS 30
    - 禁用Aero

## 直播前准备工作
1. 提前一天测试好所有直播设备服务器相关配置。

    提前测试完直播服务器后，原则上除了远程推流地址，其他设置均不再改动。

2. 如果涉及到摄像机问题，需要尽快解决

    > 占坑

3. 准备好所需要的器材。

    - 一般所有的器材都统一放在一个大包中，包平时放在诊所保管。
    - 网线（带线轴，也可能同时还有无线轴的备用网线）
    - 路由器1-2台
    - 视频信号采集卡（黑色盒状，有两个接口）
    - 插板（2+个）
    - 采集卡所需的连接线一根（USB3.0）。信号源的连接线一般由负责信号源的一方提供。
    - 过线桥（可选，应对线路经过人流密集区域的情况
    - 剪刀胶带（可选，如果线路过长有可能需要固定，一般大型活动的场馆里会有

4. 准备所需要的设备。

    至少需要两台及其以上的笔记本电脑。主要用于：
    1.  用于进行视频流的推流；
    2.  检查服务器状态以及视频流的流量是否正常；
    3.  用于检测在直播的播放页面上直播是否正常进行，并观察画质、流畅度是否符合播放要求，及时向推流设备以及信号源反应情况。

5. 在准备好相关的器材和设备之后，进行直播前的准备工作。主要分为以下几个步骤:
    1. 在直播的前一到两天到直播地点进行踩点工作，主要工作：
               1. 找到属于自己的直播位置，并在直播位置附近寻找好电源进行连接；
               2. 找到直播位置附近可用的网络端口并检查其是否可用以及是否稳定；
               3. 预估在直播地点布线的难度和工作量；
               4. 检查器材能否正常使用并且保持稳定；
               5. 检查设备上的采集卡驱动是否已经成功安装并且能与采集卡联通；
               6. 检测设备是否能在推流与监控的情况下稳定高效的运行，尽量排除由于设备的不稳定性所造成的直播的中断或者卡顿以及无法正确调试等问题。
               如果发现上述事项中出现问题，及时想办法解决困难。

    2. 直播当天提前足够的时间（具体时长自己进行预估，一般在直播开始前的半小时到一小时要完成所有的调试）到达场地。
               0. 如果是大型直播，涉及场馆布置，一定要问清楚主办人员布线时间，随其他线一起布置。
               1. 首先进行布线工作，布置好所需要的电源线以及网线，在测试电源稳定可靠后运行设备，测试当时的网络情况，布置1~2台路由器并测试路由器的网络状况（注意！必须检测路由器的网络是否是稳定可用的！）。
               2. 进行完上述工作后，让技术人员首先检查推流服务器的状况，检查必要配置，并且确保所需要的校网账号的余额是充足的（在向外网推流时需要检查）。
               3. 然后连接好采集卡，并且与信号源进行连接。在OBS上进行相关的配置，选择最稳定的设备进行推流工作，保证流的稳定性。信号源的不稳定要及时反应并且和信号的提供者进行沟通，尽快解决。

6. 进行完上述工作后，进行尝试性的推流，在nplive/bilibili上观看直播，看直播的音视频是否能正常播放，是否会出现卡顿的情况。如果有，适当调节OBS中的设置（详见直播设置文档）。 


---

# 应急预案
---
## 网断了
将推流源即使切换到实现准备好的本地画面（~~良好的用户体验~~

检查接口，电源，网线本身，路由设备及其他环节

---

# 排线规则

解决方案是对网线和光纤才用两条各自适合的线路，并且用绝缘胶带将线路尽量固定在墙角，还使用网线保护光纤的方法，对于踩的概率比较大的地方利用过线桥进行了加固（笔者感觉是比较重要的），选择从墙上过线绕过门口。
经实践检验，黄黑相间的绝缘胶带绝对是好帮手。
另外应该更加注意提前对风险做好应对方案，到现场再现想解决方案其实比较有风险。

---

# 各场馆网口分布

| 场馆     | 分布情况  | 备注        |
| ------ | ----- | --------- |
| 中关村体育馆 | 一楼办公室 | 其他的应该都是坏的 |
| 良乡足球场  | 疏桐？   |           |
| 新食堂三楼  | 没有找到  | BIT-Web吧  |
---

# 活动时间表

```c++
请按时间排序
时间:月/日 月/上中下旬
分类:学校/学院/社团
    若分类为`社团`则时间可能不固定
```
| 活动        | 时间   | 分类   | 预计直播时长     |
| --------- | ---- | ---- | ---------- |
| 网协C语言串讲   | 3/23 | 社团   | 18:30-     |
| 网协计算机二级串讲 | 3/23 | 社团   | 18:30-     |
| 五四        | 5/4  | 学校   |            |
| 毕业典礼      | 6/？  | 学校   |            |
| 军训        | 9/下旬 | 学校   |            |
| 深秋歌会      | 12/3 | 学校   | 6：30-10：00 |
| 一二丶九合唱    | 12/9 | 学校   |            |


# 避开这些坑

| 活动   | 教训                                       |
| ---- | ---------------------------------------- |
| 深秋歌会 | 一大早就要去，晚上要注意跟上校车。拉线需要很长时间。入口处人流量大，要考虑到网线的保护。估计晚上要定外卖。 |
